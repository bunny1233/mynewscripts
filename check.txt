# Windows Defender Real-Time Protection Disabler
# Simple and Clean Version

# Request admin rights if not already admin
if (-NOT ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole] "Administrator")) {
    echo "Requesting administrator rights..."
    Start-Process powershell -ArgumentList "-NoProfile -ExecutionPolicy Bypass -File `"$PSCommandPath`"" -Verb RunAs
    exit
}

echo "========================================"
echo "  Windows Defender Control Tool"
echo "========================================"
echo ""

# Check current status
echo "Checking current Defender status..."
$status = Get-MpComputerStatus
echo "Real-time protection: $($status.RealtimeProtectionEnabled)"
echo ""

# Turn OFF Defender
echo "Disabling Windows Defender real-time protection..."
Set-MpPreference -DisableRealtimeMonitoring $true
echo "Done!"
echo ""

# Verify it's off
echo "Verifying..."
Start-Sleep 2
$newStatus = Get-MpComputerStatus
echo "New status: $($newStatus.RealtimeProtectionEnabled)"
echo ""

if (-NOT $newStatus.RealtimeProtectionEnabled) {
    echo "SUCCESS: Windows Defender is now DISABLED"
    echo ""
    echo "WARNING: Your computer is not protected!"
    echo "Run this script again to re-enable when done."
} else {
    echo "FAILED: Could not disable Windows Defender"
}

echo ""
echo "========================================"
echo "Press any key to close..."
$null = $Host.UI.RawUI.ReadKey("NoEcho,IncludeKeyDown")
